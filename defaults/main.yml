---
# If you would like a report at the end accordin to OpenSCAP as to the report results
# then you should set ubtu20cis_oscap_scan to true/yes.
# NOTE: This requires the python_xmltojson package on the control host.
ubtu20cis_oscap_scan: no
ubtu20cis_report_dir: /tmp

ubtu20cis_section1_patch: true
ubtu20cis_section2_patch: true
ubtu20cis_section3_patch: true
ubtu20cis_section4_patch: true
ubtu20cis_section5_patch: true
ubtu20cis_section6_patch: true

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
ubtu20cis_complexity_high: false

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
ubtu20cis_audit_complex: true

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
# Value of true runs duscruptive tasks, value of false will skip disruptive tasks
ubtu20cis_disruption_high: true

# Show "changed" for disruptive items not remediated per disruption-high
# setting to make them stand out.
ubtu20cis_audit_disruptive: yes

ubtu20cis_skip_for_travis: false

ubtu20cis_workaround_for_disa_benchmark: true
ubtu20cis_workaround_for_ssg_benchmark: true

# tweak role to run in a chroot, such as in kickstart %post script
ubtu20cis_system_is_chroot: "{{ ansible_is_chroot | default(False) }}"

# tweak role to run in a non-privileged container
ubtu20cis_system_is_container: false

# Section 1 Fixes
# Section 1 is Iniitial setup (FileSystem Configuration, Configure Software Updates, Configure sudo, Filesystem Integrity Checking, Secure Boot Settings,
# Additional Process Hardening, Mandatory Access Control, and Warning Banners)
ubtu20cis_rule_1_1_1_1: true
ubtu20cis_rule_1_1_1_2: true
ubtu20cis_rule_1_1_1_3: true
ubtu20cis_rule_1_1_1_4: true
ubtu20cis_rule_1_1_1_5: true
ubtu20cis_rule_1_1_1_6: true
ubtu20cis_rule_1_1_1_7: true
ubtu20cis_rule_1_1_2: true
ubtu20cis_rule_1_1_3: true
ubtu20cis_rule_1_1_4: true
ubtu20cis_rule_1_1_5: true
ubtu20cis_rule_1_1_6: true
ubtu20cis_rule_1_1_7: true
ubtu20cis_rule_1_1_8: true
ubtu20cis_rule_1_1_9: true
ubtu20cis_rule_1_1_10: true
ubtu20cis_rule_1_1_11: true
ubtu20cis_rule_1_1_12: true
ubtu20cis_rule_1_1_13: true
ubtu20cis_rule_1_1_14: true
ubtu20cis_rule_1_1_15: true
ubtu20cis_rule_1_1_16: true
ubtu20cis_rule_1_1_17: true
ubtu20cis_rule_1_1_18: true
ubtu20cis_rule_1_1_19: true
ubtu20cis_rule_1_1_20: true
ubtu20cis_rule_1_1_21: true
ubtu20cis_rule_1_1_22: true
ubtu20cis_rule_1_1_23: true
ubtu20cis_rule_1_1_24: true
ubtu20cis_rule_1_2_1: true
ubtu20cis_rule_1_2_2: true
ubtu20cis_rule_1_3_1: true
ubtu20cis_rule_1_3_2: true
ubtu20cis_rule_1_3_3: true
ubtu20cis_rule_1_4_1: true
ubtu20cis_rule_1_4_2: true
ubtu20cis_rule_1_5_1: true
ubtu20cis_rule_1_5_2: true
ubtu20cis_rule_1_5_3: true
ubtu20cis_rule_1_6_1: true
ubtu20cis_rule_1_6_2: true
ubtu20cis_rule_1_6_3: true
ubtu20cis_rule_1_6_4: true
ubtu20cis_rule_1_7_1_1: true
ubtu20cis_rule_1_7_1_2: true
ubtu20cis_rule_1_7_1_3: true
ubtu20cis_rule_1_7_1_4: true
ubtu20cis_rule_1_8_1_1: true
ubtu20cis_rule_1_8_1_2: true
ubtu20cis_rule_1_8_1_3: true
ubtu20cis_rule_1_8_1_4: true
ubtu20cis_rule_1_8_1_5: true
ubtu20cis_rule_1_8_1_6: true
ubtu20cis_rule_1_9: true
ubtu20cis_rule_1_10: true

# Section 2 Fixes
# Section 2 is Services (inetd, special purpose, and service clients)
ubtu20cis_rule_2_1_1: true
ubtu20cis_rule_2_1_2: true
ubtu20cis_rule_2_2_1_1: true
ubtu20cis_rule_2_2_1_2: true
ubtu20cis_rule_2_2_1_3: true
ubtu20cis_rule_2_2_1_4: true
ubtu20cis_rule_2_2_2: true
ubtu20cis_rule_2_2_3: true
ubtu20cis_rule_2_2_4: true
ubtu20cis_rule_2_2_5: true
ubtu20cis_rule_2_2_6: true
ubtu20cis_rule_2_2_7: true
ubtu20cis_rule_2_2_8: true
ubtu20cis_rule_2_2_9: true
ubtu20cis_rule_2_2_10: true
ubtu20cis_rule_2_2_11: true
ubtu20cis_rule_2_2_12: true
ubtu20cis_rule_2_2_13: true
ubtu20cis_rule_2_2_14: true
ubtu20cis_rule_2_2_15: true
ubtu20cis_rule_2_2_16: true
ubtu20cis_rule_2_2_17: true
ubtu20cis_rule_2_3_1: true
ubtu20cis_rule_2_3_2: true
ubtu20cis_rule_2_3_3: true
ubtu20cis_rule_2_3_4: true
ubtu20cis_rule_2_3_5: true
ubtu20cis_rule_2_3_6: true
ubtu20cis_rule_2_4: true

# Section 3 Fixes
# Section 3 is Network Configuration (disable unused networks, network parameters (host and router), uncommon network protocols, and firewall configuration)
ubtu20cis_rule_3_1_1: true
ubtu20cis_rule_3_1_2: true
ubtu20cis_rule_3_2_1: true
ubtu20cis_rule_3_2_2: true
ubtu20cis_rule_3_3_1: true
ubtu20cis_rule_3_3_2: true
ubtu20cis_rule_3_3_3: true
ubtu20cis_rule_3_3_4: true
ubtu20cis_rule_3_3_5: true
ubtu20cis_rule_3_3_6: true
ubtu20cis_rule_3_3_7: true
ubtu20cis_rule_3_3_8: true
ubtu20cis_rule_3_3_9: true
ubtu20cis_rule_3_4_1: true
ubtu20cis_rule_3_4_2: true
ubtu20cis_rule_3_4_3: true
ubtu20cis_rule_3_4_4: true
ubtu20cis_rule_3_5_1_1: true
ubtu20cis_rule_3_5_1_2: true
ubtu20cis_rule_3_5_1_3: true
ubtu20cis_rule_3_5_1_4: true
ubtu20cis_rule_3_5_1_5: true
ubtu20cis_rule_3_5_1_6: true
ubtu20cis_rule_3_5_1_7: true
ubtu20cis_rule_3_5_2_1: true
ubtu20cis_rule_3_5_2_2: true
ubtu20cis_rule_3_5_2_3: true
ubtu20cis_rule_3_5_2_4: true
ubtu20cis_rule_3_5_2_5: true
ubtu20cis_rule_3_5_2_6: true
ubtu20cis_rule_3_5_2_7: true
ubtu20cis_rule_3_5_2_8: true
ubtu20cis_rule_3_5_2_9: true
ubtu20cis_rule_3_5_2_10: true
ubtu20cis_rule_3_5_3_1_1: true
ubtu20cis_rule_3_5_3_1_2: true
ubtu20cis_rule_3_5_3_1_3: true
ubtu20cis_rule_3_5_3_2_1: true
ubtu20cis_rule_3_5_3_2_2: true
ubtu20cis_rule_3_5_3_2_3: true
ubtu20cis_rule_3_5_3_2_4: true
ubtu20cis_rule_3_5_3_3_1: true
ubtu20cis_rule_3_5_3_3_2: true
ubtu20cis_rule_3_5_3_3_3: true
ubtu20cis_rule_3_5_3_3_4: true



# Service configuration variables, set to true to keep service
ubtu20cis_allow_autofs: false
ubtu20cis_allow_usb_storage: false
ubtu20cis_avahi_server: false
ubtu20cis_cups_server: false
ubtu20cis_dhcp_server: false
ubtu20cis_ldap_server: false
ubtu20cis_nfs_server: false
ubtu20cis_dns_server: false
ubtu20cis_vsftpd_server: false
ubtu20cis_httpd_server: false
ubtu20cis_dovecot_server: false
ubtu20cis_smb_server: false
ubtu20cis_squid_server: fase
ubtu20cis_snmp_server: false
ubtu20cis_rsync_server: false
ubtu20cis_nis_server: false
ubtu20cis_rpc_required: false

# Clients in use variables
ubtu20cis_nis_required: false
ubtu20cis_rsh_required: false
ubtu20cis_talk_required: false
ubtu20cis_telnet_required: false
ubtu20cis_ldap_clients_required: false
ubtu20cis_is_router: false

# IPv6 requirement toggle
ubtu20cis_ipv6_required: false

# Other system wide variables
# ubtu20cis_xwindows_required is the toggle for requiring x windows. True means you use X Windoes (not recommented for servers)
# false means you do not require X Windows enabled
ubtu20cis_xwindows_required: false

# Section 1 Control Variables
# Control 1.1.2/1.1.3/1.1.4/1.1.5
# ubtu20cis_tmp_fstab_options are the file system options for the fstabs configuration
# To conform to CIS cotnrol 1.1.2 could use any settings
# To conform to CIS control 1.1.3 nodev needs to be present
# To conform to CIS control 1.1.4 nosuid needs to be present
# To conform to CIS control 1.1.5 noexec needs to present
ubtu20cis_tmp_fstab_options: "defaults,rw,nosuid,nodev,noexec,relatime"

# Control 1.1.6/1.1.7/1.1.8/1.1.9
# ubtu20cis_dev_shm_fstab_options are the fstab file system options for /dev/shm
# To conform to CIS control 1.1.6 could use any settings
# To conform to CIS control 1.1.7 nodev needs to be present
# To conform to CIS control 1.1.8 nosuid needs to be present
# To conform to CIS control 1.1.9 noexec needs to be present
ubtu20cis_dev_shm_fstab_options: "defaults,noexec,nodev,nosuid,size=2G"

# Control 1.1.12/1.1.13/1.1.14
# These are the settings for the /var/tmp mount
# To conform to CIS control 1.1.12 nodev needs to be present in opts
# To conform to CIS control 1.1.13 nosuid needs to be present in opts
# To conform to CIS control 1.1.14 noexec needs to be present in opts
ubtu20cis_vartmp:
    source: /tmp
    fstype: none
    opts: "defaults,nodev,nosuid,noexec,bind"
    enabled: false

# Control 1.3.1
# ubtu20cis_sudo_package is the name of the sudo package to install
# The possible values are "sudo" or "sudo-ldap"
ubtu20cis_sudo_package: "sudo"

# Control 1.3.3
# ubtu20cis_sudo_logfile is the path and file name of the sudo log file
ubtu20cis_sudo_logfile: "/var/log/sudo.log"

# Control 1.4.2
# These are the crontab settings for file system integrity enforcement
ubtu20cis_aide_cron:
    cron_user: root
    cron_file: /etc/crontab
    aide_job: '/usr/bin/aide.wrapper --config /etc/aide/aide.conf --check'
    aide_minute: 0
    aide_hour: 5
    aide_day: '*'
    aide_month: '*'
    aide_weekday: '*'

# Control 1.5.3
# THIS VARAIBLE SHOULD BE CHANGED AND INCORPROATED INTO VAULT
# THIS VALUE IS WHAT THE ROOT PW WILL BECOME!!!!!!!!
# HAVING THAT PW EXPOSED IN RAW TEXT IS NOT SECURE!!!!
ubtu20cis_root_pw: "Password1"

# Control 1.8.1.1
# This will be the motd banner must not contain the below items in order to be compliant with Ubuntu 20 CIS
# \m, \r, \s, \v or references to the OS platform
ubtu20cis_warning_banner: |
        Authorized uses only. All activity may be monitored and reported.

# Section 2 Control Variables
# Control 2.2.1.1
# ubtu20cis_time_sync_tool is the tool in which to synchronize time
# The two options are chrony, ntp, or systemd-timesyncd
ubtu20cis_time_sync_tool: "ntp"

# Control 2.2.1.2
# ubtu20cis_ntp_server_list is the list ntp servers
# ubtu20cis_ntp_fallback_server_list is the list of fallback NTP servers
ubtu20cis_ntp_server_list: "0.debian.pool.ntp.org 1.debian.pool.ntp.org"
ubtu20cis_ntp_fallback_server_list: "2.debian.pool.ntp.org 3.debian.pool.ntp.org"

# Control 2.2.1.3/2.2.1.4
# ubtu20cis_chrony_server_options is the server options for chrony
ubtu20cis_chrony_server_options: "minpoll 8"
# ubtu18cis_time_synchronization_servers are the synchronization servers
ubtu20cis_time_synchronization_servers:
    - 0.pool.ntp.org
    - 1.pool.ntp.org
    - 2.pool.ntp.org
    - 3.pool.ntp.org
# ubtu20cis_chrony_user is the user that chrony will use, default is _chrony
ubtu20cis_chrony_user: "_chrony"
# ubtu20cis_ntp_server_options is the server options for ntp
ubtu20cis_ntp_server_options: "iburst"

# Control 2.2.15
# ubtu20_cis_mail_transfer_agent is the mail transfer agent in use
# The options are exim4, postfix or other
ubtu20_cis_mail_transfer_agent: "other"

# Section 3 Control Variables
# Control 3.1.2
# ubtu20cis_install_network_manager determines if this role can install network manager
ubtu20cis_install_network_manager: true

# ubtu20cis_firewall_package is the toggle for which firewall system is in use
# The valid options to use are ufw, nftables, or iptables
# Warning!! nftables is not supported in this role and will only message out if nftables is selected
# If using nftables please manually adjust firewall settings
ubtu20cis_firewall_package: "ufw"

# Control 3.5.1.5
# ubtu20cis_ufw_allow_out_ports are the ports for the firewall to allow
# if you want to allow out on all ports set variable to "all", example ubtu18cis_ufw_allow_out_ports: "all"
ubtu20cis_ufw_allow_out_ports:
    - 53
    - 80
    - 443
